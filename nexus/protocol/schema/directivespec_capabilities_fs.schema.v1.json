{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://cybros.dev/schemas/directivespec/fs-capability/v1.json",
  "title": "DirectiveSpec.capabilities.fs (FsCapabilityV1)",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "read": {
      "type": "array",
      "description": "Read access selectors. Phase 1 supports workspace-only selectors (e.g., 'workspace:**'). 'host:/...' is reserved for future use and is not guaranteed to be enforced in all profiles.",
      "items": {
        "$ref": "#/$defs/FsPathSelectorV1"
      },
      "minItems": 0,
      "uniqueItems": true
    },
    "write": {
      "type": "array",
      "description": "Write access selectors. Phase 1 supports workspace-only selectors (e.g., 'workspace:**'). 'host:/...' is reserved for future use and is not guaranteed to be enforced in all profiles.",
      "items": {
        "$ref": "#/$defs/FsPathSelectorV1"
      },
      "minItems": 0,
      "uniqueItems": true
    },
    "writable_roots": {
      "type": "array",
      "description": "Phase 2c: Host-absolute paths where read+write is allowed. Derived from policy resolution. Used by Landlock enforcement on Linux. When present, takes precedence over read/write for enforcement.",
      "items": {
        "$ref": "#/$defs/HostAbsolutePath"
      },
      "minItems": 0,
      "uniqueItems": true
    },
    "read_only_subpaths": {
      "type": "array",
      "description": "Phase 2c: Host-absolute paths where only read access is allowed. Derived from policy resolution. Used by Landlock enforcement on Linux.",
      "items": {
        "$ref": "#/$defs/HostAbsolutePath"
      },
      "minItems": 0,
      "uniqueItems": true
    }
  },
  "$defs": {
    "FsPathSelectorV1": {
      "type": "string",
      "minLength": 3,
      "maxLength": 1024,
      "description": "Selector syntax: 'workspace:**' (any path under /workspace), 'workspace:/relative/or/absolute/path', or reserved 'host:/absolute/path'.",
      "pattern": "^(workspace:(\\*\\*|/[^\\s]*)|host:/[^\\s]*)$"
    },
    "HostAbsolutePath": {
      "type": "string",
      "minLength": 1,
      "maxLength": 4096,
      "description": "Host-absolute filesystem path for Landlock enforcement.",
      "pattern": "^/[^\\s]*$"
    }
  }
}
